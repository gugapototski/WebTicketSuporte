<!DOCTYPE html>
<html>
  <head>
    <title>Página Inicial do Usuário</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body>
    <h1>Bem-vindo à Página Inicial do Usuário</h1>

    <p>Nome do Usuário: <span id="nomeUsuario"></span></p>
    <p>Tipo do Usuário: <span id="tipoUsuario"></span></p>

    <button class="btn btn-primary" onclick="criarTicket()">
      Criar Ticket
    </button>
    <button class="btn btn-primary" onclick="verTicketsAbertos()">
      Meus tickets
    </button>
    <button class="btn btn-primary" onclick="deslogar()">Deslogar</button>

    <script>
      // Verificar se o usuário está autenticado e obter informações do usuário
      const token = localStorage.getItem("token");
      const id_user = localStorage.getItem("id_user");
      const nomeUsuario = localStorage.getItem("nomeUsuario");
      const tipoUsuario = localStorage.getItem("tipoUsuario");

      if (!token) {
        // Se não houver token, redirecionar para a página de login
        console.log("Redirecionando para a página de login...");
        window.location.href = "login.html";
      } else {
        // Exibir informações do usuário
        document.getElementById("nomeUsuario").textContent = nomeUsuario;
        document.getElementById("tipoUsuario").textContent = tipoUsuario;
      }
      if (tipoUsuario !== "Comum") {
        deslogar();
      }

      function criarTicket() {
        // Redirecionar o usuário para a página de criação de tickets
        window.location.href = "criar_ticket.html";
      }

      function verTicketsAbertos() {
        // Redirecionar o usuário para a página de tickets abertos
        window.location.href = "meus_ticket.html";
      }

      function deslogar() {
        // Limpar o token do localStorage
        localStorage.removeItem("token");
        localStorage.removeItem("nomeUsuario");
        localStorage.removeItem("tipoUsuario");

        // Redirecionar o usuário para a página de login
        window.location.href = "../login.html";
      }
    </script>
  </body>
</html>
